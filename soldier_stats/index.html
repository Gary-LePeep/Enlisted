<!DOCTYPE html>
<html>

<head>

<body style="background-color:rgb(107, 133, 133);"></body>

<script type="text/javascript" src="../translations.js"></script>
<script type="text/javascript" src="./stats.js"></script>
<script type="text/javascript" src="../updates/updates.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
    // Create new css link Element
    var css = document.createElement('link');
    css.rel = 'stylesheet';
    css.type = 'text/css';
    css.href = '../style.css';
    document.getElementsByTagName('HEAD')[0].appendChild(css);
</script>
</head>

<body>

    <select id="language_dropdown" onchange="window.location.reload();"
        style="position:absolute; top:25px; left:1780px;">
        <option> English </option>
        <option> Русский </option>
    </select>


    <script>
        var topnav = document.createElement("div");
        topnav.className = "topnav";
        document.getElementsByTagName('BODY')[0].appendChild(topnav);
        var compareButton = document.createElement("button");
        compareButton.textContent = translate("linkWeaponCompare");
        compareButton.onclick = function () { window.location = "https://gary-lepeep.github.io/Enlisted" };
        topnav.appendChild(compareButton);
        var datamineButton = document.createElement("button");
        datamineButton.textContent = translate("linkDatamine");
        datamineButton.onclick = function () { window.location = "https://gary-lepeep.github.io/Enlisted/datamine" };
        topnav.appendChild(datamineButton);
        var updateButton = document.createElement("button");
        updateButton.textContent = translate("linkUpdate");
        updateButton.onclick = function () { window.location = "https://gary-lepeep.github.io/Enlisted/updates" };
        topnav.appendChild(updateButton);
        // warning if update was recent
        if (wasRecent(parseInt(document.cookie))) {
            updateButton.className = "blink-bg";
            updateButton.textContent += "⚠️";
        }
        var statsButton = document.createElement("button");
        statsButton.className = "active";
        statsButton.textContent = translate("linkStats");
        statsButton.onclick = function () { window.location = "https://gary-lepeep.github.io/Enlisted/soldier_stats" };
        topnav.appendChild(statsButton);
        topnav.appendChild(translate("language", "b", "position:absolute; top:20px; left:1700px; font-size:16px; text-align:center; color: white"));

        var title = translate("statistics", "div", "top:10px;");
        title.className = "TITLE";
        document.getElementsByTagName('BODY')[0].appendChild(title);
    </script>

    <input type="checkbox" id="ColorblindMode" onclick="ColorblindMode()" onchange="window.location.reload();" style="position:absolute; top:70px; left:1675px;">
    <script>
        document.getElementsByTagName('BODY')[0].appendChild(translate("ColorblindMode", "b", "position:absolute; top:70px; left:1700px;"));
        function ColorblindMode() {window.Colorblind = document.getElementById("ColorblindMode").checked}
        ColorblindMode();

        var statsHeader = document.createElement("div");
        statsHeader.style = "position: relative; top: 20px; height: 25px; width: 99%; text-align: center";
        document.getElementsByTagName('BODY')[0].appendChild(statsHeader)
        statsHeader.appendChild(translate("statsHeader", 'b'));

        var table = document.createElement("table");
        table.style = "position: relative; top: 50px; left: 10%; width: 80%";
        document.getElementsByTagName('BODY')[0].appendChild(table);
        var tableHeader = document.createElement("thead");
        table.appendChild(tableHeader);
        var tableHeaderRow = document.createElement("tr");
        tableHeader.appendChild(tableHeaderRow);
        var perksImage = document.createElement("img");
        perksImage.src = window.Colorblind ? "../resources/perks_cb.png" : "../resources/perks.png";
        perksImage.style = "width: 150px";
        tableHeaderRow.appendChild(perksImage);
        tableHeaderRow.appendChild(translate("★", "th"));
        tableHeaderRow.appendChild(translate("★★", "th"));
        tableHeaderRow.appendChild(translate("★★★", "th"));
        tableHeaderRow.appendChild(translate("★★★★", "th"));
        tableHeaderRow.appendChild(translate("★★★★★", "th"));
        tableHeaderRow.appendChild(translate("defaultPerk", "th"));

        for (var i = 0; i < SOLDIER_STATS.length; i++) {
            var tableBody = document.createElement("tbody");
            table.appendChild(tableBody);
            for (var j = 0; j < SOLDIER_STATS[i].length; j++) {
                var tableRow = document.createElement("tr");
                tableBody.appendChild(tableRow);
                tableRow.appendChild(formatName(SOLDIER_STATS[i][j]["Name"]));
                var STARS = [0, 2, 4, 6, 12]
                for (var k = 0; k < STARS.length; k++) {
                    var star = document.createElement("td");
                    formatStats(star, SOLDIER_STATS[i][j]["Stats"], STARS[k])
                    tableRow.appendChild(star);
                }
                tableRow.appendChild(translate(" " + SOLDIER_STATS[i][j]["Talent"], "td", "text-align: left; padding: 0px 0px 0px 30px"));
            }
        }

        var sellTable = document.createElement("table");
        sellTable.style = "position: relative; top: 55px; left: 10.2%; width: 79.6%";
        document.getElementsByTagName('BODY')[0].appendChild(sellTable);
        var sellTableHeader = document.createElement("thead");
        sellTableHeader.style = "border: 0px";
        sellTable.appendChild(sellTableHeader);
        var sellTableHeaderRow = document.createElement("tr");
        sellTableHeader.appendChild(sellTableHeaderRow);
        var topLeft = document.createElement("th");
        topLeft.style = "background-color: rgb(68, 44, 32); border: 2px solid rgb(44, 27, 18); height: 25px";
        var bronzeImage = document.createElement("img");
        bronzeImage.src = "../resources/bronze.png";
        bronzeImage.style = "position: absolute; top: 0px; width: 30px; left: 75px";
        bronzeImage.textContent = "bronze_sale";
        topLeft.appendChild(bronzeImage);
        topLeft.appendChild(translate("bronze_sale", "div"));
        sellTableHeaderRow.appendChild(topLeft);
        sellTableHeaderRow.appendChild(translate("★ - 0%", "th", "background-color: rgb(68, 44, 32); border: 2px solid rgb(44, 27, 18)"));
        sellTableHeaderRow.appendChild(translate("★★ - " + Math.round(100 * 49 / 102) + "%", "th", "background-color: rgb(68, 44, 32); border: 2px solid rgb(44, 27, 18)"));
        sellTableHeaderRow.appendChild(translate("★★★ - " + Math.round(100 * 39 / 102) + "%", "th", "background-color: rgb(68, 44, 32); border: 2px solid rgb(44, 27, 18)"));
        sellTableHeaderRow.appendChild(translate("★★★★ - " + Math.round(100 * 14 / 102) + "%", "th", "background-color: rgb(68, 44, 32); border: 2px solid rgb(44, 27, 18)"));
        sellTableHeaderRow.appendChild(translate("★★★★★ - 1%", "th", "background-color: rgb(68, 44, 32); border: 2px solid rgb(44, 27, 18)"));

        var sellTableBody = document.createElement("tbody");
        sellTableBody.style = "border: 0px";
        sellTable.appendChild(sellTableBody);
        for (var i = 0; i < SELL_STATS.length; i++) {
            var sellTableRow = document.createElement("tr");
            sellTableBody.appendChild(sellTableRow);
            sellTableRow.appendChild(formatName(SELL_STATS[i]["Name"], true));
            for (var j = 0; j < SELL_STATS[i]["Sell"].length; j++) {
                sellTableRow.appendChild(translate(SELL_STATS[i]["Sell"][j], "td", "background-color: rgb(51, 31, 22); border: 2px solid rgb(80, 55, 45); width: 200px"));
            }
        }

        var statsFooter = document.createElement("div");
        statsFooter.style = "position: relative; top: 55px; height: 25px; width: 99%; text-align: center";
        document.getElementsByTagName('BODY')[0].appendChild(statsFooter)
        statsFooter.appendChild(translate("statsFooter", 'b'));

        function formatName(name, brown = false) {
            var halves = name.split("#");
            name = halves[1] != null ? translate(halves[0]) + " " + halves[1] : translate(halves[0]);
            if (brown) {
                return translate(name, "td", "background-color: rgb(51, 31, 22); border: 2px solid rgb(80, 55, 45)");
            }
            return translate(name, "td")
        }

        function formatStats(element, array, offset) {
            COLORBLIND_COLORS = ["color: #25ac88", "color: #d65153", "color: #db7329"]
            COLORS = ["color: rgb(155, 255, 155)", "color: rgb(255, 155, 155)", "color: rgb(255, 255, 155)"]

            for (var i = 0; i < 3; i++) {
                element.append(translate("_", "b", "color: #262626"));
                if (array[i] + offset < 10) {
                    element.append(translate(" ", "b", "color: #262626"));
                }
                element.append(translate(array[i] + offset + " ", "b", window.Colorblind ? COLORBLIND_COLORS[i] : COLORS[i]));
                if (array[i] + offset < 10) {
                    element.append(translate(" ", "b", "color: #262626"));
                }
                element.append(translate("_", "b", "color: #262626"));
                if (i < 2) {
                    element.append(translate("- ", "b", "color: #FFFFFF"));
                }
            }
        }
    </script>
</body>

</html>